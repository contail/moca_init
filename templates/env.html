{% load staticfiles %}
<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>
<div style="width:480px; height:160px; ">

  <div style="float:left; width:20%; height: 30%; margin-left:30%; margin-top:5%;">
    <button id="ip_address" type="button" class="btn btn-danger btn-lg" data-toggle="modal" data-target="#ip_addressModal" style="margin-top:20px;height:50px;width:200px"> <h4>아이피설정</h4>  </button>
    <button id="port" type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#portModal" style="margin-top:20px;height:50px;width:200px"> <h4>포트설정</h4>  </button>
    <button id="batch_size" name="open" href="#" data-toggle="modal" data-target="#batch_sizeModal" class="btn btn-danger btn-lg" style="margin-top:20px;height:50px;width:200px"> <h4>batch size 설정</h4>  </button>
    <button id="fps" type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#fpsModal" style="margin-top:20px;height:50px;width:200px"> <h4>fps설정</h4>  </button>
  </div>

  <div style="clear:both;"></div>

</div>


<!-- FPS -->
<div class="modal fade bd-example-modal-sm" id="fpsModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm"role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">FPS 설정</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form>
          <input name="csrfmiddlewaretoken" type="hidden" value="{{ csrf_token }}">
          <div class="form-group"  style="text-align:center">
            <button type="button" onclick="up('fps')">
            <img src="{% static 'img/up.png' %}" style="width:40px; height:40px"/>
          </button>
            <input type="number" id="fps_value"  value="{{ fps }}" style="width:40px; margin-left :10px"/>
             <button type="button" onclick="down('fps')">
            <img src="{% static 'img/down.png' %}" style="width:40px; height:40px"/>
          </button>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
        <button type="button" class="btn btn-primary" onclick="save('fps')">저장</button>
      </div>
    </div>
  </div>
</div>


<!-- Port-->
<div class="modal fade bd-example-modal-sm" id="portModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm"role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" >Port 설정</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form>

          <div class="form-group"  style="text-align:center">
            <button type="button" onclick="up('port')">
            <img src="{% static 'img/up.png' %}" style="width:40px; height:40px"/>
          </button>
            <input type="number" id="port_value"  value="{{ port }}" style="width:40px; margin-left :10px"/>
             <button type="button" onclick="down('port')">
            <img src="{% static 'img/down.png' %}" style="width:40px; height:40px"/>
          </button>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
        <button type="button" class="btn btn-primary" onclick="save('port')">저장</button>
      </div>
    </div>
  </div>
</div>

<!-- batch_size-->
<div class="modal fade bd-example-modal-sm" id="batch_sizeModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm"role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" >배치사이즈 설정</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form>

          <div class="form-group"  style="text-align:center">
            <button type="button" onclick="up('batch_size')">
            <img src="{% static 'img/up.png' %}" style="width:40px; height:40px"/>
          </button>
            <input type="number" id="batch_size_value"  value="{{ batch_size }}" style="width:40px; margin-left :10px"/>
             <button type="button" onclick="down('batch_size')">
            <img src="{% static 'img/down.png' %}" style="width:40px; height:40px"/>
          </button>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
        <button type="button" class="btn btn-primary" onclick="save('batch_size')">저장</button>
      </div>
    </div>
  </div>
</div>

<!-- ip_address-->
<div class="modal fade bd-example-modal-sm" id="ip_addressModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-sm"role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" >ip_address 설정</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form>

          <div class="form-group"  style="text-align:center">
            <button type="button" onclick="up('ip_address')">
            <img src="{% static 'img/up.png' %}" style="width:40px; height:40px"/>
          </button>
            <input type="radio" id="ip1"  name="ip_address" value="{{ ip1 }}" style="width:40px; margin-left :5px"/><span id="span_ip1">{{ ip1 }}</span>.
            <input type="radio" id="ip2"  name="ip_address" value="{{ ip2 }}" style="width:40px; margin-left :5px"/><span id="span_ip2">{{ ip2 }}</span>.
            <input type="radio" id="ip3"  name="ip_address" value="{{ ip3 }}" style="width:40px; margin-left :5px"/><span id="span_ip3">{{ ip3 }}</span>.
            <input type="radio" id="ip4"  name="ip_address" value="{{ ip4 }}" style="width:40px; margin-left :5px"/><span id="span_ip4">{{ ip4 }}</span>
             <button type="button" onclick="down('ip_address')">
            <img src="{% static 'img/down.png' %}" style="width:40px; height:40px"/>
          </button>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
        <button type="button" class="btn btn-primary" onclick="save('ip_address')">저장</button>
      </div>
    </div>
  </div>
</div>

</body>

<script>

function up(type){

  if(type =='fps'){
    var a = document.getElementById('fps_value')
    a.value = Number(a.value)+1;
  }
  if(type =='port'){
    var a = document.getElementById('port_value')
    a.value = Number(a.value)+1;
  }
  if(type =='ip_address'){

    var a = $('input[name="ip_address"]:checked').val();
    a = Number(a)+1;
    $('input[name="ip_address"]:checked').val(a);
    var radioId = $('input[name=ip_address]:checked').attr('id');
    var s_id = 'span_'+radioId;
    document.getElementById(s_id).innerHTML = a;

  }
  if(type =='batch_size'){
    var a = document.getElementById('batch_size_value')
    a.value = Number(a.value)+1;
  }

}

function down(type){

  if(type =='fps'){
    var a = document.getElementById('fps_value')
    a.value = Number(a.value)-1;
  }
  if(type =='port'){
    var a = document.getElementById('port_value')
    a.value = Number(a.value)-1;
  }
  if(type =='ip_address'){
    var a = $('input[name="ip_address"]:checked').val();
    a = Number(a)-1;
    $('input[name="ip_address"]:checked').val(a);
    var radioId = $('input[name=ip_address]:checked').attr('id');
    var s_id = 'span_'+radioId;
    document.getElementById(s_id).innerHTML = a;
  }
  if(type =='batch_size'){
    var a = document.getElementById('batch_size_value')
    a.value = Number(a.value)-1;
  }

}

function save(type){


   if (type =='ip_address'){
    var set_value = document.getElementById('span_ip1').innerText+'.'+document.getElementById('span_ip2').innerText+'.'+document.getElementById('span_ip3').innerText+'.'+document.getElementById('span_ip4').innerText;
    console.log(set_value);
   }
   else{
    var values = type+'_'+'value';
    var set_value = document.getElementById(values).value
   }

            var data = {'value': set_value,'type':type}
            console.log(data);
            $.ajax({
                url: '/settings/change_env_values',
                type: 'get',
                async: false,
                data : data,
                dataType: 'json',
                success: function (data) {
                    alert(data['message']);
                    window.location.reload();
                },
                error:function(request,status,error){
                    alert("code:"+request.status+"\n\n"+"message:"+request.responseText);
                },
                cache: false,

            });
}
</script>
</html>